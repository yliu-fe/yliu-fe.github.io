
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="我的个人网页">
      
      
        <meta name="author" content="yliu-fe">
      
      
        <link rel="canonical" href="https://yliu-fe.github.io/Majors/Time-Series%20Analysis/3_Conditional%20Heteroscedasticity/">
      
      
        <link rel="prev" href="../2_Basic%20TimeSeries/">
      
      
        <link rel="next" href="../../Non_Parametric/Gaussian_Process/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>三、条件异方差模型 - Website of a Doctor Candidate</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans SC";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Website of a Doctor Candidate" class="md-header__button md-logo" aria-label="Website of a Doctor Candidate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Website of a Doctor Candidate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              三、条件异方差模型
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="切换为夜间模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换为夜间模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="切换为日间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换为日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/yliu-fe/yliu-fe.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    yliu-fe
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../About/" class="md-tabs__link">
          
  
  关于

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Techs/tech_index/" class="md-tabs__link">
          
  
  计算机笔记

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../Major_index/" class="md-tabs__link">
          
  
  专业笔记

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Entertainment/ett_index/" class="md-tabs__link">
          
  
  消遣娱乐

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Website of a Doctor Candidate" class="md-nav__button md-logo" aria-label="Website of a Doctor Candidate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Website of a Doctor Candidate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/yliu-fe/yliu-fe.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    yliu-fe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    关于
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            关于
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to my Blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../About/cv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Curriculum Vitae
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算机笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            计算机笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/tech_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常用计算机技术笔记索引
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Matlab笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Matlab笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Matlab/general/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MkDocs疑难杂症研究
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            MkDocs疑难杂症研究
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Mkdocs/MathJax%E7%9A%84%E5%BC%95%E5%85%A5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引入MathJax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Mkdocs/Github%20pages%20note/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何联动Github Pages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Mkdocs/PyMdown_blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何使用PyMdown blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Mkdocs/Settings_Code_Blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何配置代码块
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Mkdocs/Comment%20with%20Giscus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    利用Giscus配置评论区
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Astro笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Astro笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Astro/Deploy%20Astro%20to%20Github%20Pages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Astro部署网页至Github Pages
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LaTeX杂症研究
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            LaTeX杂症研究
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20LaTeX/Notes%20for%20Table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    利用threeparttable包实现表格的note
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python掉坑笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Python掉坑笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_1" >
        
          
          <label class="md-nav__link" for="__nav_2_6_1" id="__nav_2_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    基本语法
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_1">
            <span class="md-nav__icon md-icon"></span>
            基本语法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Python/Basic%20Syntax/args_kwargs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    形参"args"和"kwargs"
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_2" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    各类包
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            各类包
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Python/Packages/numpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    numpy专题
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_3" >
        
          
          <label class="md-nav__link" for="__nav_2_6_3" id="__nav_2_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CS61A
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_3">
            <span class="md-nav__icon md-icon"></span>
            CS61A
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Python/CS61A/61a_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页：希望这不是一个笑话
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Techs/Notes%20for%20Python/CS61A/recursive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高阶函数、递归和hw2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    专业笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            专业笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Major_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    我的专业相关领域文档
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    截面数据计量经济学
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            截面数据计量经济学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Cross-Sectional%20Econometrics/About%20cross-section%20data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页：截面计量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Cross-Sectional%20Econometrics/1_OLS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一、线性模型和最小二乘法
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    时间序列计量经济学
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            时间序列计量经济学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TS_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页：时间序列计量经济学
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Background/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一、一点预备内容
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_Basic%20TimeSeries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    二、基本时间序列模型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    三、条件异方差模型
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    三、条件异方差模型
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 波动率
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 波动率">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      波动率计算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 建立异方差模型的准备
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 建立异方差模型的准备">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      建立波动率模型的步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arch" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH效应检验
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-arch" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 ARCH模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 ARCH模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arch1" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH(1)模型的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arch_1" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH模型的优劣
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arch_2" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH模型的建模过程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-garch" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 GARCH模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.4 GARCH模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#garch11" class="md-nav__link">
    <span class="md-ellipsis">
      GARCH(1,1)模型的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch11_1" class="md-nav__link">
    <span class="md-ellipsis">
      GARCH(1,1)的预测
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch" class="md-nav__link">
    <span class="md-ellipsis">
      GARCH的峰度（尾部性）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-garch" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 GARCH的衍生模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 GARCH的衍生模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#garch_1" class="md-nav__link">
    <span class="md-ellipsis">
      求和GARCH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch_2" class="md-nav__link">
    <span class="md-ellipsis">
      门限GARCH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch_3" class="md-nav__link">
    <span class="md-ellipsis">
      指数GARCH
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-var" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 在险价值(VaR)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6 在险价值(VaR)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      风险分类和评估方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#var" class="md-nav__link">
    <span class="md-ellipsis">
      VaR的定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#var_1" class="md-nav__link">
    <span class="md-ellipsis">
      VaR的计算
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#var_2" class="md-nav__link">
    <span class="md-ellipsis">
      VaR的优缺点
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 一致性风险度量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.7 一致性风险度量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#varvar" class="md-nav__link">
    <span class="md-ellipsis">
      条件VaR：满足一致性风险度量的VaR变种
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-i-garchvar" class="md-nav__link">
    <span class="md-ellipsis">
      3.8 风险度量制：基于I-GARCH模型计算VaR
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.8 风险度量制：基于I-GARCH模型计算VaR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#var_3" class="md-nav__link">
    <span class="md-ellipsis">
      计算组合的VaR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-var" class="md-nav__link">
    <span class="md-ellipsis">
      3.9 VaR的分位数估计方法（非参方法）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.9 VaR的分位数估计方法（非参方法）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      经验分位数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      分位数回归
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    非参数方法
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            非参数方法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Non_Parametric/Gaussian_Process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一、高斯过程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            强化学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/RL_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页：强化学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_2" >
        
          
          <label class="md-nav__link" for="__nav_3_5_2" id="__nav_3_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deepmind RL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_2">
            <span class="md-nav__icon md-icon"></span>
            Deepmind RL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/Deepmind%20RL/DMRL_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于课程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/Deepmind%20RL/1_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一、强化学习的介绍
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_3" >
        
          
          <label class="md-nav__link" for="__nav_3_5_3" id="__nav_3_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    伯克利CS188
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_3">
            <span class="md-nav__icon md-icon"></span>
            伯克利CS188
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS188/Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于课程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_5_3_2" id="__nav_3_5_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    作业
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_3_2">
            <span class="md-nav__icon md-icon"></span>
            作业
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement Learning/CS188/homework/Homework 1 Search.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    作业1 搜索
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_5_3_3" id="__nav_3_5_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    项目
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_5_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_3_3">
            <span class="md-nav__icon md-icon"></span>
            项目
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS188/projects/Project%201%20Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    项目1 搜索
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS188/Section1.1%20Uninformed%20Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 盲目搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS188/Section1.2%20A_star%20Search%20and%20Heuristics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 A*搜索和启发式搜索
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_4" >
        
          
          <label class="md-nav__link" for="__nav_3_5_4" id="__nav_3_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    伯克利CS285
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_4">
            <span class="md-nav__icon md-icon"></span>
            伯克利CS285
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS285/CS285_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于课程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS285/2_Imitation%20Learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    二、模仿学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS285/HW1_Imitation%20Learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    作业一、模仿学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Reinforcement%20Learning/CS285/4_Intro%20of%20RL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    四、强化学习导引
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    消遣娱乐
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            消遣娱乐
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Entertainment/ett_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    拉丁语
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            拉丁语
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Entertainment/Lingua%20Latino/Latin_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    引导页：拉丁语
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 波动率
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 波动率">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      波动率计算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 建立异方差模型的准备
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 建立异方差模型的准备">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      建立波动率模型的步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arch" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH效应检验
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-arch" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 ARCH模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 ARCH模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arch1" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH(1)模型的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arch_1" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH模型的优劣
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arch_2" class="md-nav__link">
    <span class="md-ellipsis">
      ARCH模型的建模过程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-garch" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 GARCH模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.4 GARCH模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#garch11" class="md-nav__link">
    <span class="md-ellipsis">
      GARCH(1,1)模型的性质
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch11_1" class="md-nav__link">
    <span class="md-ellipsis">
      GARCH(1,1)的预测
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch" class="md-nav__link">
    <span class="md-ellipsis">
      GARCH的峰度（尾部性）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-garch" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 GARCH的衍生模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 GARCH的衍生模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#garch_1" class="md-nav__link">
    <span class="md-ellipsis">
      求和GARCH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch_2" class="md-nav__link">
    <span class="md-ellipsis">
      门限GARCH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garch_3" class="md-nav__link">
    <span class="md-ellipsis">
      指数GARCH
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-var" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 在险价值(VaR)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6 在险价值(VaR)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      风险分类和评估方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#var" class="md-nav__link">
    <span class="md-ellipsis">
      VaR的定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#var_1" class="md-nav__link">
    <span class="md-ellipsis">
      VaR的计算
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#var_2" class="md-nav__link">
    <span class="md-ellipsis">
      VaR的优缺点
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 一致性风险度量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.7 一致性风险度量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#varvar" class="md-nav__link">
    <span class="md-ellipsis">
      条件VaR：满足一致性风险度量的VaR变种
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-i-garchvar" class="md-nav__link">
    <span class="md-ellipsis">
      3.8 风险度量制：基于I-GARCH模型计算VaR
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.8 风险度量制：基于I-GARCH模型计算VaR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#var_3" class="md-nav__link">
    <span class="md-ellipsis">
      计算组合的VaR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-var" class="md-nav__link">
    <span class="md-ellipsis">
      3.9 VaR的分位数估计方法（非参方法）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.9 VaR的分位数估计方法（非参方法）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      经验分位数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      分位数回归
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="_1">条件异方差系列模型</h1>
<p>前一章节，我们讲了一阶矩信息（条件均值）的描述和分析。在这一章中，我们将着重讨论二阶矩信息（条件方差）的分析。说到条件异方差，股票是一种较为常见的场景。而股票的波动率，即股票对数收益率的条件标准差，则是常见的一个讨论对象：</p>
<div class="arithmatex">\[
\sigma_t \mid F_{t-1}
\]</div>
<h2 id="31">3.1 波动率</h2>
<div class="admonition info">
<p class="admonition-title">参考书目</p>
<p>参阅：Tsay, R. S. (2013). Analysis of financial time series. John Wiley &amp; Sons. 章节4。</p>
</div>
<p>股票波动率的特征有：</p>
<ul>
<li>无法被直接观测；</li>
<li>存在波动率聚集现象，在部分时间段上存在较高的波动率，而在零一段时间内波动率较低；</li>
<li>波动率以连续时间变化，或者说，波动率序列的跳跃不频繁；</li>
<li>波动率不发散到无穷，或者说，波动率序列是有界的、平稳的；</li>
<li>波动率常存在一个“杠杆效应”，波动率对标的资产价格的大幅上升/下降反映不一致（不对称）。</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">波动率是不连续的</p>
<p>由于存在休市时间，波动是不连续的，特别是在隔夜的时段内波动率无法被直接观测，当然，日内（交易时段内）连续的波动率变化是可以得到计算的。</p>
</div>
<p>波动率可以应用在多种场景中：</p>
<p>第一，<strong>衍生品定价</strong>。如BSM公式，BSM模型假定标的资产价格服从几何布朗运动（GBM）。而BSM对欧式期权的定价公式为：</p>
<div class="arithmatex">\[
P_j(S_j,K) = S_j \Phi(\frac{-\ln(K/S_j) + \mu_j}{\sigma_j} + \kappa \sigma_c + \sigma_j) - \frac{K}{1+r_f}\Phi(\frac{-\ln(K/S_j)+\mu_j}{\sigma_j} + \kappa \sigma_c)
\]</div>
<p>显然，里面包含着<span class="arithmatex">\(\sigma_j\)</span>，即标的资产对数收益率的状态标准差，但这种“波动率”被称作隐含波动率，即已知当前价格的情况下根据BSM公式反推得出的波动率值。</p>
<details>
<summary>关于BSM模型</summary>
<p>以上内容表示了已知主要参数后，Black-Scholes-Merton模型对欧式看涨期权（European Call）的定价方法。其中，<span class="arithmatex">\(S_j\)</span>代表标的资产的价格(underlying asset price)，<span class="arithmatex">\(K\)</span>代表期权的执行价格(strike price)，<span class="arithmatex">\(\mu_j\)</span>代表标的资产的收益率均值，<span class="arithmatex">\(\sigma_j\)</span>代表标的资产的波动率【即我们要求的那个波动率】，<span class="arithmatex">\(r_f\)</span>是市场无风险收益率，如果是连续计息，则<span class="arithmatex">\(1/(1+r_f)\)</span>表示的贴现过程可以表示为<span class="arithmatex">\(e^{-r}\)</span>。数学记号<span class="arithmatex">\(\Phi\)</span>表示标准正态分布的累积分布函数（PDF）</p>
<p>其遵循的理论背景、基本假设，以及推导过程请参阅BSM模型原文献：</p>
<ul>
<li>Black, F., &amp; Scholes, M. (1973). The pricing of options and corporate liabilities. Journal of political economy, 81(3), 637-654.</li>
<li>Merton, R. C. (1973). Theory of rational option pricing. The Bell Journal of economics and management science, 141-183.</li>
</ul>
<p>或者相关教材，如Huang &amp; Litzenberger的"Foundations for Financial Economics"（《金融经济学基础》），Sheldon Ross的“An Elementary Introduction to Mathematical Finance”(《数理金融初步》)。John Hull的"Options, Futures, and Other Derivatives"（《期权、期货和其他衍生品》）也有相关内容。</p>
</details>
<p>第二，<strong>风险管理</strong>。例如在险价值(Value of Risk, VaR）。</p>
<p>第三，<strong>资产组合选择与定价</strong>。例如Markwitz(1952)模型，对于一组资产来说，有<span class="arithmatex">\((\mu,\Sigma)\)</span>，前者为资产的收益率均值矩阵，后者为资产的协方差矩阵。从而衍生为动态模型，即<span class="arithmatex">\((\mu_t, \Sigma_t)\)</span>，做成AR(1)模型，即：</p>
<div class="arithmatex">\[
\begin{aligned}
   r_{i,t} &amp;= \alpha_i + \beta_i r_{F,t-1} + \epsilon_i\\
   \sigma_i^2 &amp;= \beta_i + \sigma_F^2 + \sigma_{\epsilon, i}^2\\
   \sigma_{i,j} &amp;= \beta_i \beta_j \sigma_F^2
   \end{aligned}
\]</div>
<p>第四，<strong>区间预测</strong>。通过波动率，在点估计的基础上求其置信区间。</p>
<h3 id="_2">波动率计算</h3>
<p>波动率的计算方法有多种，如隐含波动率，或利用高频的历史信息近似计算。</p>
<p>第一， <strong>隐含波动率</strong>。已知资产的价格，带入BSM公式，辅以其他的参数，解出<span class="arithmatex">\(\sigma_j\)</span>。现实中常见的例子如VIX指数。
第二，<strong>高频下的估计</strong>。如果利用高频的历史信息，并将时间区段无限细分，也可以近似的计算当前的波动率。令<span class="arithmatex">\(r_t\)</span>表示某资产对数收益率，假定某月内存在等间隔的交易日，我们可以观测到一条对数收益率的序列<span class="arithmatex">\(\{r_t\}\)</span>，从而满足:</p>
<div class="admonition danger">
<p class="admonition-title">高频下的波动率估计</p>
<p>但实务中，高频数据估计可能存在较高的误差</p>
</div>
<div class="arithmatex">\[
r_t = \sum_{i=1}^n r_{t,i}, \quad \text{假定月内有$n$个交易日}
\]</div>
<p>则称</p>
<div class="arithmatex">\[
RV_t = \sum_{i=1}^n r_{t,i}^2
\]</div>
<p>为<span class="arithmatex">\(r_t\)</span>已实现的波动率，其中假定<span class="arithmatex">\(\{r_{t,i}\}_{i=1}^n\)</span>为均值为0，方差有限且独立同分布的随机变量序列。基于以上假定和设定，经验结果表明<span class="arithmatex">\(\ln(RV_t)\)</span>序列近似服从于高斯ARIMA(0,1,q)模型。</p>
<p>第三， <strong>计量模型估计</strong>。使用计量模型进行估计的思路是，资产收益率的波动率来自于资产定价模型的扰动，而资产价格的扰动项<span class="arithmatex">\(\{a_t\}\)</span>虽然非序列相关，但是可能存在“相依”的关系。下面介绍计量模型的结构，已知<span class="arithmatex">\(t-1\)</span>时刻下的信息集<span class="arithmatex">\(F_{t-1}\)</span>，其<span class="arithmatex">\(r_t\)</span>的条件均值和条件方差为：</p>
<details>
<summary>扰动项的“相依”</summary>
<p>其证据是，在实际观测中，我们经常观测到<span class="arithmatex">\(|r_t|\)</span>或者<span class="arithmatex">\(r_t^2\)</span>存在强烈的序列相关性。</p>
</details>
<div class="arithmatex">\[
\begin{aligned}
      \mu_t &amp;= E(r_t \mid F_{t-1})\\
      \sigma_t^2 &amp;= \operatorname{Var}(r_t \mid F_{t-1}) = E[(r_t - \mu)^2 \mid F_{t-1}]\\
      \end{aligned}
\]</div>
<p>而如果<span class="arithmatex">\(\{r_t\}\)</span>是弱平稳序列，则<span class="arithmatex">\(r_t = \mu_t + a_t\)</span>，对应有：</p>
<div class="arithmatex">\[
\begin{aligned}
   \mu_t &amp;= \sum_{i=1}^p \phi_i y_{t-i} - \sum_{i=1}^q \theta_i a_{t-i};\\
   y_t &amp;= r_t - \phi_0 - \sum_{i=1}^k \beta_i x_{it}
\end{aligned}
\]</div>
<p>基于以上内容，可以解得<span class="arithmatex">\(\sigma_t^2\)</span>的形式：</p>
<div class="arithmatex">\[
\begin{aligned}
   \sigma_t^2 &amp;= \operatorname{Var}(r_t \mid F_{t-1}) = \operatorname{Var}(\mu_t + a_t \mid F_{t-1})\\
   &amp;=  \operatorname{Var}(a_t\mid F_{t-1})
\end{aligned}
\]</div>
<h2 id="32">3.2 建立异方差模型的准备</h2>
<p>异方差模型可以分为两类：</p>
<ul>
<li>确定函数来刻画<span class="arithmatex">\(\sigma_t\)</span>的演变，代表模型如GARCH；</li>
<li>随机方程来描述<span class="arithmatex">\(\sigma_t^2\)</span>，如BSM模型，不作为本课程讲述内容。</li>
</ul>
<p>本课程主要讲述的是单变量波动率模型，其最经典的模型是Engel(1982)提出的自相关条件异方差（ARCH）模型，及其身后的改进型。</p>
<ol>
<li>ARCH模型，由Engel(1982)提出。前面提到了股票波动率的聚集(clustering)现象，而ARCH模型最早提出了如何刻画波动率聚集现象。</li>
<li>GARCH。由Bollerslev(1986)基于ARCH改进，其贡献在于解决了ARCH在低阶参数上的问题。</li>
<li>GARCH-M模型。加入了均值调整。</li>
<li>I-GARCH。解决了波动率尺度上的单位根问题。</li>
<li>E-GARCH。Nelson(1991)提出。</li>
<li>T-GARCH。Zakoian(1994)提出。E/T-GARCH模型描述了波动率序列中存在的杠杆效应。</li>
<li>CHARMA，即“条件异方差自回归平均移动模型”。由Tsay(1987)提出，该模型允许引入了<span class="arithmatex">\(a_t\)</span>序列的滞后项之间的交叉项。</li>
</ol>
<p>后一类思路（随机方程）的代表如：</p>
<ol>
<li>RCA，即“随机系数自回归模型”。由Nicholls(1982)提出，允许了参数随时间<span class="arithmatex">\(t\)</span>的变化而变化。</li>
<li>SV，即“随机波动率模型”。由Melino(1990)提出。</li>
</ol>
<h3 id="_3">建立波动率模型的步骤</h3>
<ol>
<li>通过检验数据的相关性，首先建立条件均值方程。具体的内容，请见上一大章节（AR/MA/ARMA/ARIMA)。</li>
<li>对均值方程的残差，即<span class="arithmatex">\(\{a_t\}\)</span>序列做ARCH效应检验。</li>
<li>根据前序ARCH效应检验的结果决定——如果显著，则可以指定一个波动率方程进行拟合。</li>
<li>检验所拟合的模型。</li>
</ol>
<h3 id="arch">ARCH效应检验</h3>
<p>ARCH效应检验的思路是。记<span class="arithmatex">\(a_t = r_t - \mu_t\)</span>为均值方程的残差，来检验<span class="arithmatex">\(a_t^2\)</span>的条件异方差性（也就是所谓的“ARCH效应”）。换句话说，我们要检验<span class="arithmatex">\(\{a_t^2\}\)</span>是否是独立同分布的，一般有两种检验方法。</p>
<ol>
<li><strong>Ljung-Box</strong>检验。思路是检验序列<span class="arithmatex">\(\{a_t^2\}\)</span>是否序列相关，即<span class="arithmatex">\(H0: \rho_1 = \rho_2 = ... = \rho_m = 0\)</span>。</li>
<li><strong>拉格朗日乘子（LM）检验</strong>。</li>
</ol>
<details>
<summary>Lagrange Multiplier Test</summary>
<p>在如下的线性回归中，用一个F统计量，检验：</p>
<div class="arithmatex">\[
a_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + ... + \alpha_m a_{t-m}^2 + e_t, \quad t = m+1,...,T
\]</div>
<p>中<span class="arithmatex">\(\alpha_i = 0\)</span>，即<span class="arithmatex">\(H0: \alpha_1 = \alpha_2 = ... = \alpha_m =  0\)</span>。其中<span class="arithmatex">\(e_t\)</span>为误差项，<span class="arithmatex">\(m\)</span>为指定的阶数，<span class="arithmatex">\(T\)</span>是样本容量。进而构建F统计量如下：</p>
<div class="arithmatex">\[
\begin{align}
   SSR_0 &amp;= \sum_{t=m+1}^T (a_t^2 - \bar W), \quad \bar W = \frac{1}{T} \sum_{t=1}^T a_t^2, \quad \text{$\bar W$是$\{a_t^2\}$的样本均值}\\
   SSR_1 &amp;= \sum_{t=1}^T \hat e_t^2, \quad \text{$\hat e_t^2$是线性最小二乘的估计残差}\\
   F &amp;= \frac{(SSR_0 - SSR_1)/m}{SSR_1/(T-2m-1)} \sim \chi^2(m)
\end{align}
\]</div>
</details>
<h2 id="33-arch">3.3 ARCH模型</h2>
<p>在通过ARCH效应检验后，就可以用ARCH模型做拟合了。Engel(1982)对ARCH模型的推导中，首先拆解了扰动项<span class="arithmatex">\(a_t\)</span>：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + ... + \alpha_m a_{t-m}^2
\]</div>
<p>显然，上面的函数形式表明（1）ARCH模型中的扰动项<span class="arithmatex">\(a_t\)</span>，不相关，但不是独立的，是“相互依存”的；（2）函数描述了<span class="arithmatex">\(a_t\)</span>的不独立性。其中，<span class="arithmatex">\(\epsilon_t\)</span>为独立同分布且均值为0、方差为1的随机序列[^5]；而<span class="arithmatex">\(\alpha_0 &gt; 0\)</span>且<span class="arithmatex">\(\alpha_i \geq 0, \quad \forall i &gt; 0\)</span>。</p>
<p>这一模型表明，如果存在一个比较大的过去扰动<span class="arithmatex">\(\{a_{t-i}^2\}_{i=1}^m\)</span>，按照<span class="arithmatex">\(\sigma_t^2\)</span>的模型设定，就会导致较大的当期波动率<span class="arithmatex">\(\sigma_t^2\)</span>，从而可能导致较大的当期扰动<span class="arithmatex">\(a_t\)</span>，进而可能造成当期存在较大的<span class="arithmatex">\(r_t\)</span>，再进一步，就可能导致未来出现大的<span class="arithmatex">\(\sigma_t^2\)</span>。这一个影响链条的存在，使得大的扰动倾向于导致另一个大的扰动紧随着出现，从而描述了波动性聚集现象。因而，这种波动性聚集的现象也被称作ARCH效应。</p>
<h3 id="arch1">ARCH(1)模型的性质</h3>
<p>ARCH(1)指的是，当期的扰动仅与上期的扰动相关。即：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha_0 +\alpha_1 a_{t-1}^2,\quad \alpha_0,\alpha_1 &gt; 0
\]</div>
<p>第一， <strong>无条件均值</strong>。扰动的无条件均值为：</p>
<div class="arithmatex">\[
E(a_t) = E[E(a_t\mid F_{t-1})] = E[\sigma_t E(\epsilon_t)] = 0
\]</div>
<p>第二， <strong>无条件方差</strong>。扰动的无条件方差的计算可以变为期望的形式：</p>
<div class="arithmatex">\[
\begin{aligned}
   \operatorname{Var}(a_t) &amp;= E[a_t^2] = E[E(a_t^2 \mid F_{t-1})] = E[E(\sigma_t^2 \epsilon_t^2\mid F_{t-1})]\\
   &amp;= E[\sigma_t^2 E(\epsilon_t^2 \mid F_{t-1})] = E(\sigma_t^2)\\
   &amp;= E(\alpha_0 + \alpha_1 a_{t-1}^2) = \alpha_0 + \alpha_1 E(a_{t-1}^2)\\
   &amp;\Rightarrow \operatorname{Var}(a_t) = \frac{\alpha_0}{1-\alpha_1}, \quad 0&lt;\alpha_1&lt;1
\end{aligned}
\]</div>
<p>第三， <strong>ACF</strong>。自己推，本质上是<span class="arithmatex">\(\operatorname{Var}(a_t a_{t-l})\)</span>。</p>
<p>第四， <strong>尾部性</strong>。由于讨论对象的特殊性，扰动项很在意较大的波动率情形，因而需要讨论扰动项<span class="arithmatex">\(a_t\)</span>的尾部性质。</p>
<details>
<summary>尾部性的讨论</summary>
<p>为了讨论方便，这里要求<span class="arithmatex">\(a_t\)</span>的四阶矩有限，并假定<span class="arithmatex">\(\epsilon_t \sim N(0,1)\)</span>。那么<span class="arithmatex">\(\epsilon_t\)</span>的峰度为3。基于以上内容展开推导：</p>
<div class="arithmatex">\[
\begin{aligned}
    \text{已知}\quad K_\epsilon &amp;= E[(\frac{\epsilon_t - \mu_\epsilon}{\sigma_\epsilon})^4] = \frac{E(\epsilon_t^4)}{[\operatorname{Var}(\epsilon)]^2} = E(\epsilon_t^4) = 3\\
    \text{求扰动项的峰度}\quad K_a &amp;= \frac{E(a_t^4)}{[\operatorname{Var}(a_t)]^2}
\end{aligned}
\]</div>
<p>由上面第一式得，<span class="arithmatex">\(E(\epsilon_t^4) = E(a_t^4/\sigma_t^4) = 3\)</span>，从而有<span class="arithmatex">\(E(a_t^4) / E[(\sigma_t^2)^2] = 3\)</span>，即<span class="arithmatex">\(E(a_t^4) = 3 E[(\alpha_0 + \alpha_1 a_{t-1}^2)^2]\)</span>：</p>
<div class="arithmatex">\[
\begin{aligned}
   E(a_t^4) &amp;= 3E[\alpha_0^2 + 2\alpha_0 \alpha_1 a_{t-1}^2 + \alpha_1^2 a_{t-1}^4] \\
   &amp;= \frac{3\alpha_0^2(1+\alpha_1)}{(1-3\alpha_1^2)(1-\alpha_1)}
\end{aligned}
\]</div>
<p>那么<span class="arithmatex">\(a_t\)</span>的峰度为：</p>
<div class="arithmatex">\[
K_a = \frac{E(a_t^4)}{[\operatorname{Var}(a_t)]^2} = \frac{3\alpha_0^2(1+\alpha_1)}{(1-3\alpha_1^2)(1-\alpha_1)} / \frac{\alpha_0^2}{(1-\alpha_1)^2} = \frac{3(1-\alpha_1^2)}{1-3\alpha_1^2}
\]</div>
<p>分式结构显然大于1，因而<span class="arithmatex">\(a_t\)</span>的峰度<span class="arithmatex">\(K_a\)</span>显然大于3。</p>
</details>
<p>以上内容说明：</p>
<ul>
<li><span class="arithmatex">\(\{a_t\}\)</span>的尾部特征比正态分布的尾部要厚。这说明条件ARCH(1)模型的扰动，比高斯白噪声序列更容易产生极端值。</li>
<li>在峰度的讨论中我们发现<span class="arithmatex">\(1-3\alpha_1^2 &gt; 0\)</span>（这个条件出现在<span class="arithmatex">\(K_a\)</span>最终形式的分母上），从而使<span class="arithmatex">\(\alpha_1\)</span>的取值范围进一步限定在<span class="arithmatex">\(0 &lt; \alpha_1^2 &lt; 1/3\)</span>上。</li>
</ul>
<h3 id="arch_1">ARCH模型的优劣</h3>
<p>其优点在于：</p>
<ul>
<li>结构简单，方便描述金融市场中的波动率聚集现象；</li>
<li>描述了金融市场中收益率扰动项的厚尾性。</li>
</ul>
<blockquote>
<p>如果讨论尾部性时假定<span class="arithmatex">\(\epsilon_t\)</span>服从学生t分布，则更进一步可以推导出<span class="arithmatex">\(a_t\)</span>序列是尖峰厚尾的。</p>
</blockquote>
<p>缺点在于：</p>
<ul>
<li>假定了正负扰动对波动率存在相同的影响（没有考虑实际中扰动影响的不对称性）；</li>
<li>ARCH模型对参数的限制较强，例如ARCH(1)要求<span class="arithmatex">\(\alpha_1^2 \in (0,1/3)\)</span>；</li>
<li>对波动率变化的解释性不强；</li>
<li>ARCH模型对波动率的预测会偏高，因为ARCH模型对孤立的一个巨大扰动反应较为迟钝。</li>
</ul>
<h3 id="arch_2">ARCH模型的建模过程</h3>
<p>第一步， <strong>定阶</strong>。如果ARCH效应检验结果显著，则可用<span class="arithmatex">\(\{a_t^2\}\)</span>序列的PACF来确定ARCH模型的阶数。</p>
<details>
<summary>证明：PACF可以用于对ARCH模型的定阶</summary>
<p>下面简单证明PACF可以用于ARCH的定阶。对于ARCH(m)模型，有：</p>
<div class="arithmatex">\[
\sigma_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + ... + \alpha_m a_{t-m}^2
\]</div>
<p>对于给定的样本，可知<span class="arithmatex">\(a_t^2\)</span>是<span class="arithmatex">\(\sigma_t^2\)</span>的无偏估计。进而可建立<span class="arithmatex">\(\{a_t^2\}\)</span>的<span class="arithmatex">\(m\)</span>阶自回归模型，即AR(m)。定义残差序列<span class="arithmatex">\(\eta_t = a_t^2 - \sigma_t^2\)</span>，则可证明<span class="arithmatex">\(\{\eta_t\}\)</span>是一个均值不为0的鞅差序列（martingale difference series）。进而，ARCH(m)模型可以被改写为：</p>
<div class="arithmatex">\[
a_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + ... + \alpha_m a_{t-m^2} + \eta_t
\]</div>
<p>这就是<span class="arithmatex">\(\{a_t^2\}\)</span>序列的AR(m)形式，因而可以用PACF来定阶。</p>
</details>
<details>
<summary>鞅差序列（Martingale Difference Serie）</summary>
<p>简要介绍鞅差序列。如果<span class="arithmatex">\(\{Y_t\}_{t=1}^\infty\)</span>序列满足<span class="arithmatex">\(E(Y_t) = 0, \quad \forall t\)</span>，且对于<span class="arithmatex">\(t = 2,3,...\)</span>，有：</p>
<div class="arithmatex">\[
E(Y_t \mid Y_{t-1},Y_{t-2},...) = 0
\]</div>
<p>则称<span class="arithmatex">\(\{Y_t\}\)</span>为“鞅差（分）序列”。其特性在于，基于鞅差序列过去值的任何函数均不能用于预测；但是其高阶矩信息是可以用来预测的。设定一个序列<span class="arithmatex">\(\{Y_t\}\)</span>为鞅差序列的假设强于<span class="arithmatex">\(\{Y_t\}\)</span>序列相关假设，但显著弱于序列独立假设，因为鞅差序列假设未排除高阶矩信息<span class="arithmatex">\(E(Y_t^2\mid Y_{t-1},...)\)</span>依赖于过去观测值的可能性。</p>
</details>
<p>第二步，<strong>估计</strong>。对于ARCH(m)模型：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + ... + \alpha_m a_{t-m}^2
\]</div>
<p>相较于之前的AR、MA模型，ARCH是一个双方程模型，因而在估计上存在一定的困难。问题在于<span class="arithmatex">\(\epsilon_t\)</span>的分布问题。</p>
<details>
<summary>(a) 如果<span class="arithmatex">\(\epsilon_t\)</span>服从正态分布？</summary>
<p>如果<span class="arithmatex">\(\epsilon_t\)</span>服从正态分布，则ARCH(m)模型的似然函数可以列为：</p>
<div class="arithmatex">\[
\begin{aligned}
f(a_1,...,a_T \mid \mathbf{\alpha}) &amp;= f(a_T \mid F_{T-1}) f(a_{T-1} \mid F_{T-2}) \ldots f(a_{m+1} \mid F_m) f(a_1,...,a_m \mid \mathbf{\alpha})\\
&amp;= \prod_{t = m+1}^T \frac{1}{\sigma_t \sqrt{2\pi}} \exp (-\frac{a_t^2}{2\sigma_t^2}) \times f(a_1,...,a_m \mid \mathbf{\alpha})
\end{aligned}
\]</div>
<p>其中<span class="arithmatex">\(\mathbf{\alpha} = (\alpha_0,...,\alpha_m)^T\)</span>。如果<span class="arithmatex">\(T\)</span>较大（观测值很多），则可以舍弃掉无条件概率（先验概率）<span class="arithmatex">\(f(a_1,..,a_m \mid \mathbf{\alpha})\)</span>，然后转到条件似然函数：</p>
<div class="arithmatex">\[
\begin{aligned}
l(a_{m+1},...,a_T \mid \mathbf{\alpha}, a_1,...,a_m) &amp;= \prod_{t=m+1}^T [-\frac{1}{2}\ln(2\pi) - \frac{1}{2}\ln(\sigma_t^2) - \frac{1}{2}\frac{a_t^2}{\sigma_t^2}]\\
&amp;= -\prod_{t=m+1}^T [\frac{1}{2}\ln(2\sigma_t^2) + \frac{1}{2}\frac{a_t^2}{\sigma_t^2}]
\end{aligned}
\]</div>
<p>最大化上式所得估计（求解上面对数条件似然函数的FOC），称作服从正态假设条件下的最大似然估计。</p>
</details>
<details>
<summary>(b) 如果<span class="arithmatex">\(\epsilon_t\)</span>服从学生t分布？</summary>
<p>如果<span class="arithmatex">\(\epsilon_t\)</span>服从学生t分布，设<span class="arithmatex">\(x_v\)</span>服从自由度为<span class="arithmatex">\(v\)</span>的学生t分布，则：</p>
<div class="arithmatex">\[
\operatorname{Var}(x_v) = \frac{v}{v-2}, \quad v&gt;2
\]</div>
<p>令：</p>
<div class="arithmatex">\[
\epsilon_t = \frac{x_v}{\sqrt{\frac{v}{v-2}}}
\]</div>
<p>则<span class="arithmatex">\(\epsilon_t\)</span>的PDF可以表示为：</p>
<div class="arithmatex">\[
f(\epsilon_t \mid v) = \frac{\Gamma(\frac{v+1}{2})}{\Gamma(\frac{v}{2})\sqrt{(v-2)\pi}} (1+\frac{\epsilon_t^2}{v-2})^{-(v+1)/2}, \quad v &gt; 2
\]</div>
<p>其中<span class="arithmatex">\(\Gamma\)</span>为Gamma函数，其中<span class="arithmatex">\(\Gamma(x) := \int_0^\infty y^{x-1} e^{-y} dy\)</span>。从而有条件似然函数如下：</p>
<div class="arithmatex">\[
f(a_{m+1},...,a_T \mid \mathbf{\alpha}, a_1,...,a_m) = \prod_{t=m+1}^T \frac{\Gamma(\frac{v+1}{2})}{\Gamma(\frac{v}{2})\sqrt{(v-2)\pi}} \frac{1}{\sigma_t} \left[1+\frac{\epsilon_t^2}{(v-2)\sigma_t^2}\right]^{-(v+1)/2}
\]</div>
<p>最大化上式得到的估计，称为服从学生t分布下的极大似然估计。一般来说，<span class="arithmatex">\(v\in [4,8]\)</span>。（1）若<span class="arithmatex">\(v\)</span>事先已知，则可以在上式两侧同取对数，从而消除Gamma函数运算；（2）如果<span class="arithmatex">\(v\)</span>未知，则可以一起估计，即除了常规待估参数外，还要一起估计<span class="arithmatex">\(v\)</span>，具体结构参见Tsay书pp.121。</p>
</details>
<details>
<summary>(c) 如果<span class="arithmatex">\(\epsilon_t\)</span>服从广义误差分布？</summary>
<p>若<span class="arithmatex">\(\epsilon_t\)</span>服从广义误差分布, 此时的PDF形式为：</p>
<div class="arithmatex">\[
f(x) = \frac{v \exp(-\frac{1}{2}|\frac{x}{\lambda}|^v)}{\lambda 2^{(1+1/v)} \Gamma(1/v)}, \quad -\infty &lt; x &lt; +\infty, \quad 0&lt; v&lt; \infty
\]</div>
<p>其中<span class="arithmatex">\(\lambda = [2^{-2/v} \Gamma(1/v) \Gamma(3/v)]^{1/2}\)</span>。如果<span class="arithmatex">\(v = 2\)</span>，则广义误差分布退化为正态分布；而<span class="arithmatex">\(v &lt; 2\)</span>时广义误差分布具有厚尾性。</p>
</details>
<p>第三步，<strong>模型验证</strong>。给定一个得到正确定阶的ARCH模型，则其标准化残差：</p>
<div class="arithmatex">\[
\tilde a_t = \frac{a_t}{\sigma_t}
\]</div>
<p>是一个独立同分布的随机序列。下面进行一系列操作：</p>
<ul>
<li><strong>均值方程充分性</strong>。对<span class="arithmatex">\(\tilde \alpha_t\)</span>采用Ljung-Box检验，检验均值方程<span class="arithmatex">\(r_t = \mu + a_t\)</span>的充分性。</li>
<li><strong>波动率方程正确性</strong>。使用<span class="arithmatex">\(\tilde \alpha_t^2\)</span>的Ljung-Box统计量来检验波动率方程的正确性。</li>
<li><strong><span class="arithmatex">\(\epsilon_t\)</span>分布假定的合理性</strong>。检验<span class="arithmatex">\(\{\tilde a_t\}\)</span>序列的偏度、峰度、QQ图（各类矩信息）来检验<span class="arithmatex">\(\epsilon_t\)</span>分布假设的合理性。</li>
</ul>
<p>第四步，<strong>模型预测</strong>。令<span class="arithmatex">\(h\)</span>为预测的原点，则当前拥有的信息称作<span class="arithmatex">\(F_t\)</span>，现在基于ARCH模型，对<span class="arithmatex">\(\sigma_t^2\)</span>向前预测。</p>
<div class="arithmatex">\[
\begin{align}
   \text{（根据波动率方程向前一步）}\quad &amp; \sigma_h^2(1) = \alpha_0 + \alpha_1 a_h^2 + ... + \alpha_m a_{h+1-m}^2\\
   \text{（向前两步）}\quad &amp; \sigma_h^2(2) = \alpha_0 + \alpha_1 \sigma_h^2(1) + \alpha_2 a_h^2 + ... + \alpha_m a_{h+2-m}^2\\
   \text{（向前$l$步）}\quad &amp; \sigma_h^2(l) = \alpha_0 + \sum_{t=1}^m \alpha_i \sigma_h^2(l-i)
\end{align}
\]</div>
<p>对于最后一个式子，如果<span class="arithmatex">\(l-i \leq 0\)</span>，则<span class="arithmatex">\(\sigma_h^2 (l-i) = a_{h+l-i}^2\)</span>。而经验证据表明，ARCH模型对波动率的远期预测值往往比实际值偏高。</p>
<h2 id="34-garch">3.4 GARCH模型</h2>
<p>ARCH模型不适合于阶数太高的情况，因为这样会损失大量的样本容量（用于建立模型），因而Bollerslev(1986)提出了GARCH模型。对于对数收益率序列<span class="arithmatex">\(\{r_t\}\)</span>，令<span class="arithmatex">\(a_t = r_t - \mu_t\)</span>为<span class="arithmatex">\(t\)</span>时刻的信息，称<span class="arithmatex">\(a_t\)</span>服从一个GARCH(m,s)模型的条件是：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha_0 + \sum_{i=1}^m \alpha_i a_{t-i}^2 + \sum_{j=1}^s  \beta_j \sigma_{t-j}^2
\]</div>
<p>相比于ARCH(m)模型，GARCH(m,s)加了<span class="arithmatex">\(s\)</span>组<span class="arithmatex">\(\sigma_t\)</span>的滞后自回归项。上式右侧式子的第二项称作ARCH项，第三项称为<span class="arithmatex">\(\sigma_t^2\)</span>的自回归项。其中<span class="arithmatex">\(\{\epsilon_t\}\)</span>序列是均值为0，方差为1的独立同分布随机序列，且有<span class="arithmatex">\(\alpha_0 &gt; 0,\alpha_i \geq 0, \beta_j \geq 0\)</span>，此外，还要有：</p>
<div class="arithmatex">\[
\sum_{i=1}^{\max(m,s)} (\alpha_i + \beta_i) &lt; 1
\]</div>
<p>从而保证<span class="arithmatex">\(\{a_t\}\)</span>的无条件方差有限。</p>
<details>
<summary>该条件合理性的证明</summary>
<p>证明一下这个条件确实能让<span class="arithmatex">\(a_t\)</span>的无条件方差有限。令<span class="arithmatex">\(\eta_t = a_t^2 - \sigma_t^2\)</span>，等价于<span class="arithmatex">\(\sigma_t^2 = a_t^2 - \eta_t\)</span>，从而有：</p>
<div class="arithmatex">\[
\sigma_{t-i}^2 = a_{t-i}^2 - \eta_{t-i}, \quad i = 0,...,s
\]</div>
<p>将上式代入波动率方程，有：</p>
<div class="arithmatex">\[
a_t^2 = \alpha_0 + \sum_{i=1}^{\max(m,s)} (\alpha_i + \beta_i)a_{t-i}^2 + \eta_t - \sum_{j=1}^s \beta_j \eta_{t-j}
\]</div>
<p>从而变成了一个<span class="arithmatex">\(a_t^2\)</span>的ARMA模型，易证<span class="arithmatex">\(\{\eta_t\}\)</span>为鞅差序列，即：</p>
<div class="arithmatex">\[
E(\eta_t) = 0,\quad E(\eta_t \mid F_{t-1}) = 0, \quad \forall t
\]</div>
<p>从而知<span class="arithmatex">\(\{\eta_t\}\)</span>为一个服从同一个分布的独立同分布序列。利用<span class="arithmatex">\(\{a_t^2\}\)</span>序列的ARMA模型无条件均值，有：</p>
<div class="arithmatex">\[
E(a_t^2) = \frac{\alpha_0}{1-\sum_{i=1}^{\max(m,s)} (\alpha_i + \beta_i)}
\]</div>
<p>而显然<span class="arithmatex">\(a_t^2\)</span>的期望应当不小于0，从而有分母不小于0，即有<span class="arithmatex">\(\sum_{i=1}^{\max(m,s)} (\alpha_i + \beta_i) &lt; 1\)</span>。</p>
</details>
<h3 id="garch11">GARCH(1,1)模型的性质</h3>
<p>从最简单的GARCH(1,1)模型入手，其形式为：</p>
<div class="arithmatex">\[
\sigma_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + \beta_1 \sigma_{t-1}^2
\]</div>
<p>这个模型可以得到如下性质：</p>
<p>【1】显然，如果<span class="arithmatex">\(a_{t-1}^2\)</span>或<span class="arithmatex">\(\sigma_t^2\)</span>很大，那么当期的<span class="arithmatex">\(\sigma_t^2\)</span>一般会较大，从而刻画了波动率聚集现象。</p>
<p>【2】四阶矩信息。</p>
<div class="arithmatex">\[
\frac{E[a_t^4]}{E[(a_t^2)]^2} = \frac{3[1-(\alpha_1 + \beta_1)^2]}{1-2\alpha_1^2 - (\alpha_1+\beta_1)^2} &gt; 3
\]</div>
<p>只要保证分母项大于0，则整个峰度必然大于3，从而刻画了波动率的厚尾现象。</p>
<p>【3】用较少的参数的函数刻画了波动率的演变。经验之谈，GARCH(1,1/2,1/1,2)就可以较好的刻画波动率的演变。因为低阶的GARCH模型损失的信息较少（对样本容量的磨损较小），且准确性比对应的ARCH要好。</p>
<h3 id="garch11_1">GARCH(1,1)的预测</h3>
<p>以<span class="arithmatex">\(h\)</span>为预测原点，则：</p>
<div class="arithmatex">\[
\text{（基于GARCH模型向前一步）} \sigma_h^2(1) = \alpha_0 + \alpha_1 a_h^2 + \beta_1 \sigma_h^2
\]</div>
<p>对于多步预测，通过<span class="arithmatex">\(a_t^2 = \sigma_t^2 \epsilon_t^2\)</span>改写GARCH(1,1)：</p>
<div class="arithmatex">\[
\begin{align}
    &amp;\sigma_{t+1}^2 = \alpha_0 + (\alpha_1 +\beta_1) \sigma_t^2 + \alpha_1 \sigma_t^2 (\epsilon_t^2 - 1)\\
    \text{（令$t = h+1$）}\quad&amp; \sigma_{h+2}^2 = \alpha_0 + (\alpha_1 + \beta_1 \sigma_{h+1}^2 \alpha_1 \sigma_{h+1}^2 (\epsilon_{h+1}^2 - 1)
\end{align}
\]</div>
<p>取期望，有：</p>
<div class="arithmatex">\[
\sigma_h^2(2) = \alpha_0 + (\alpha_1 + \beta_1) \sigma_h^2(1)
\]</div>
<p>那么，一般化的向前<span class="arithmatex">\(l\)</span>步预测式可以写为：</p>
<div class="arithmatex">\[
\sigma_h^2(l) = \alpha_0 + (\alpha_1 + \beta_1) \sigma_h^2(l-1), \quad l&gt;1
\]</div>
<p>这种预测的情况和ARMA(1,1)模型一致。基于上式重复迭代，得到简明结果：</p>
<div class="arithmatex">\[
\sigma_h^2(l) = \frac{\alpha_0[1-(\alpha_1 + \beta_1)^{l-1}]}{1-(\alpha_1 + \beta_1)} + (\alpha_1 + \beta_1)^{l-1} \sigma_h^2(1)
\]</div>
<p>当<span class="arithmatex">\(l \to \infty\)</span>，且<span class="arithmatex">\(\alpha_1 + \beta_1 &lt; 1\)</span>，则：</p>
<div class="arithmatex">\[
\sigma_h^2(l) \to \frac{\alpha_0}{1-(\alpha_1 + \beta_1)},\quad \text{when $l \to \infty$}
\]</div>
<p>换句话说，向前多步预测，最终会收敛到<span class="arithmatex">\(\operatorname{Var}(a_t)\)</span>即无条件方差。</p>
<h3 id="garch">GARCH的峰度（尾部性）</h3>
<p>接下来讨论一下<span class="arithmatex">\(\{a_t\}\)</span>序列的尾部性质，体现在GARCH模型的峰度。考虑GARCH(1,1)模型：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha_0 + \alpha_1 a_{t-1}^2 + \beta_1 \sigma_{t-1}^2
\]</div>
<p>（再写一遍）其中<span class="arithmatex">\(\{\epsilon_t\}\)</span>序列是均值为0，方差为1的独立同分布随机序列，且有<span class="arithmatex">\(\alpha_0 &gt; 0,\alpha_i \geq 0, \beta_j \geq 0\)</span>，且满足：</p>
<div class="arithmatex">\[
E(\epsilon_t) = 0, \operatorname{Var}(\epsilon_t) = 1, E(\epsilon_t^4) = K_{\epsilon} + 3
\]</div>
<p>其中<span class="arithmatex">\(K_{\epsilon}\)</span>代表<span class="arithmatex">\(\epsilon\)</span>的超额峰度（如果大于0，则整体峰度大于3，从而表明厚尾性质）。基于以上假设，有：</p>
<ul>
<li><span class="arithmatex">\(\operatorname{a_t} = E(\sigma_t^2) = \alpha_0 [1-(\alpha_1+\beta_1)]\)</span>。</li>
<li><span class="arithmatex">\(E(a_t^4) = (K_{\epsilon} + 3) E(\sigma_t^4)\)</span>。只要<span class="arithmatex">\(E(\sigma_t^4)\)</span>存在。</li>
</ul>
<p>先看一看<span class="arithmatex">\(E(\sigma_t^4)\)</span>，这个可以通过波动率方程来计算，两边同取平方后取期望：</p>
<div class="arithmatex">\[
\begin{aligned}
    E(\sigma_t^4) &amp;= \alpha_0^2 + \alpha_1^2 E(a_{t-1}^4) + \beta_1^2 E(\sigma_{t-1}^4) + 2\alpha_0 \alpha_1 E(a_{t-1}^2) + 2\alpha_0 \beta_1 E(\sigma_{t-1}^2) + 2\alpha_1 \beta_1 E(\sigma_{t-1}^2 a_{t-1}^2) \\
    &amp;= \alpha_0^2 + \alpha_1^2 E(a_t^4) + \beta_1^2 E(\sigma_t^4) + 2\alpha_0 \alpha_1 E(a_t^2) + 2\alpha_0 \beta_1 E(a_t^2) + 2\alpha_1 \beta_1 E(\sigma_t^4)\\
    &amp;= \frac{\alpha_0^2(1+\alpha_1 + \beta_1)}{[1-(\alpha_1 + \beta_1)] [1-\alpha_1^2(K_\epsilon + 2) - (\alpha_1 + \beta_1)^2]}
\end{aligned}
\]</div>
<p>因而，为了使这个四阶矩存在，应当有<span class="arithmatex">\(0 \leq \alpha_1 +\beta_1 &lt; 1\)</span>，且分母大于0，即：</p>
<div class="arithmatex">\[
[1-(\alpha_1 + \beta_1)] [1-\alpha_1^2(K_\epsilon + 2) - (\alpha_1 + \beta_1)^2] &gt; 0
\]</div>
<p>在保证四阶矩信息<span class="arithmatex">\(E(\sigma_t^4)\)</span>存在的情况下，就可以讨论<span class="arithmatex">\(a_t\)</span>的超额峰度。如果<span class="arithmatex">\(a_t\)</span>的超额峰度<span class="arithmatex">\(K_a\)</span>存在，则：</p>
<div class="arithmatex">\[
\begin{aligned}
    K_a &amp;= \frac{E(a_t^4)}{[E(a_t^2)]^2} - 3 = \frac{E(a_t^4)}{\operatorname{Var}^2(a_t)} - 3\\
    &amp;= \frac{(K_{\epsilon} +3) [1-(\alpha_1 + \beta_1)^2]}{1-2\alpha_1^2 - (\alpha_1 + \beta_1)^2 - K_\epsilon \alpha_1^2} - 3
\end{aligned}
\]</div>
<p>现在就<span class="arithmatex">\(\epsilon_t\)</span>服从的分布做讨论。</p>
<details>
<summary>a）<span class="arithmatex">\(\epsilon_t\)</span>服从正态分布</summary>
<p><span class="arithmatex">\(\epsilon_t\)</span>服从正态分布，则<span class="arithmatex">\(K_\epsilon = 0\)</span>，从而有：</p>
<div class="arithmatex">\[
K_a^{(g)} = \frac{6\alpha_1^2}{1-2\alpha_1^2 - (\alpha_1+\beta_1)^2}
\]</div>
<p>进一步做出讨论：</p>
<ul>
<li>若<span class="arithmatex">\(1-2\alpha_1^2 - (\alpha_1+\beta_1)^2 &gt; 0\)</span>，则<span class="arithmatex">\(a_t\)</span>的峰度存在；</li>
<li>若<span class="arithmatex">\(\alpha_1 = 0\)</span>，则<span class="arithmatex">\(K_a^{(g)} = 0\)</span>，对应的GARCH(1,1)无厚尾；</li>
<li>若<span class="arithmatex">\(\beta_1 = 0\)</span>，模型退化到ARCH(1)模型，必然有厚尾，且必然有<span class="arithmatex">\(\alpha_1^2 &lt; 1/3\)</span>，符合ARCH(1)对系数的额外规定。</li>
</ul>
</details>
<details>
<summary>b）<span class="arithmatex">\(\epsilon_t\)</span>不服从正态分布</summary>
<p><span class="arithmatex">\(\epsilon_t\)</span>不服从正态分布，则<span class="arithmatex">\(K_\epsilon &gt;0\)</span>，从而有：</p>
<div class="arithmatex">\[
\begin{aligned}
   K_a &amp;=  \frac{K_\epsilon - K_\epsilon (\alpha_1 + \beta_1) + 6\alpha_1^2 + 3K_\epsilon \alpha_1^2}{1-2\alpha_1^2 - (\alpha_1 + \beta_1)^2 - K_\epsilon \alpha_1^2}\\
   &amp;= \frac{K_\epsilon + K_a^{(g)} + \frac{5}{6} K_\epsilon K_a^{(g)}}{1-\frac{1}{6} K_\epsilon K_a^{(g)}}
\end{aligned}
\]</div>
<p>上式对应的结论对任意的GARCH模型都成立。</p>
</details>
<p>对于ARCH(1)模型，即<span class="arithmatex">\(\beta_1 = 0\)</span>的情形，则高斯情形下<span class="arithmatex">\(a_t\)</span>的超额峰度为：</p>
<div class="arithmatex">\[
K_a^{(g)} = \frac{6\alpha_1^2}{1-3\alpha_1^2}
\]</div>
<p>那么，非高斯情形下的超额峰度为：</p>
<div class="arithmatex">\[
K_a = \frac{(K_\epsilon + 3) (1-\alpha_1^2)}{1-(K_\epsilon+3)\alpha_1^2} - 3
\]</div>
<p>进一步可以推出，对于GARCH(1,1)模型来说，<span class="arithmatex">\(\alpha_1\)</span>对决定<span class="arithmatex">\(a_t\)</span>的尾部行为起到关键的作用。对应的几个结论如下：</p>
<ul>
<li>当<span class="arithmatex">\(\alpha_1 = 0\)</span>时，有<span class="arithmatex">\(K_a^{(g)} = 0\)</span>，那么此时<span class="arithmatex">\(a_t\)</span>的尾部行为与标准白噪声一致；</li>
<li>当<span class="arithmatex">\(\alpha_1 &gt; 0\)</span>时，有<span class="arithmatex">\(K_a^{(g)} &gt; 0\)</span>，从而可知<span class="arithmatex">\(a_t\)</span>存在厚尾性质；</li>
<li>如果<span class="arithmatex">\(\epsilon_t\)</span>服从自由度为<span class="arithmatex">\(v\)</span>的学生t分布。若<span class="arithmatex">\(v &gt; 4\)</span>，则有<span class="arithmatex">\(E(\epsilon_t^4) = \frac{6}{v-4} - 3\)</span>，对应<span class="arithmatex">\(K_\epsilon = \frac{6}{v-4}\)</span>。那么对应的<span class="arithmatex">\(a_t\)</span>的超额峰度为：</li>
</ul>
<div class="arithmatex">\[
K_a = \frac{6+(v+1)K_a^{(g)}}{v-4 - K_a^{(g)}}
\]</div>
<p>要求<span class="arithmatex">\(1-\frac{2\alpha_1^2(v-1)}{v-4} - (\alpha_1+\beta_1)^2 &gt; 0\)</span>。</p>
<h2 id="35-garch">3.5 GARCH的衍生模型</h2>
<p>本部分介绍GARCH模型的各类衍生模型，如求和GARCH（I-GARCH）、门限GARCH（T-GARCH）、指数GARCH（E-GARCH）。</p>
<h3 id="garch_1">求和GARCH</h3>
<p>The Integrated GARCH，简称I-GARCH模型。回顾一下GARCH模型的基本形式：</p>
<div class="arithmatex">\[
a_t^2 = \alpha_0 + \sum_{i=1}^{\max(m,s)} (\alpha_i + \beta_i)a_{t-i}^2 + \eta_t - \sum_{j=1}^s \beta_j \eta_{t-j}
\]</div>
<p>考虑这个式子中AR部分，即<span class="arithmatex">\(\sum_{i=1}^{\max(m,s)} (\alpha_i + \beta_i) a_{t-i}^2\)</span>，如果这一部分中存在至少一个单位根，则称该GARCH模型为I-GARCH。由于单位根的存在，I-GARCH模型中过去的扰动<span class="arithmatex">\(\eta_{t-i} = a_{t-i}^2 - \sigma_{t-i}^2\)</span>对当前的扰动<span class="arithmatex">\(a_t^2\)</span>存在持续性（无衰减）的影响。</p>
<p>【1】 <strong>I-GARCH(1,1)模型的形式</strong>。以I-GARCH(1,1)为例，其基本形式为：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha_0 + \beta_1 \sigma_{t-1}^2 + (1-\beta_1) a_{t-1}^2
\]</div>
<p>其中假定<span class="arithmatex">\(\epsilon_t\)</span>独立同分布，并且要求<span class="arithmatex">\(0&lt;\beta_i &lt; 1\)</span>。由于I-GARCH模型是存在单位根的GARCH，且只有一期滞后，因此必然有<span class="arithmatex">\(\alpha_1 + \beta_1 = 1\)</span>，从而得到上式。</p>
<p>【2】 <strong>I-GARCH(1,1)模型的向前预测</strong>。下面讨论I-GARCH(1,1)模型的向前预测，设<span class="arithmatex">\(h\)</span>为预测的起点，则一般GARCH(1,1)模型向前<span class="arithmatex">\(l\)</span>步预测的形式为：</p>
<div class="arithmatex">\[
\sigma_h^2(l) = \alpha_0 + (\alpha_1 + \beta_1) \sigma_h^2(l-1), \quad l&gt;1
\]</div>
<p>而对于I-GARCH(1,1)，可以得到类似的结论：</p>
<div class="arithmatex">\[
\sigma_h^2(l) = \sigma_h^2(1) + (l-1)\alpha_0,
      \quad l \geq 1
\]</div>
<p>而<span class="arithmatex">\(\alpha_0\)</span>显然是一个常数，因此向前预测随着步数的增多，其方差线性增长，如图所示。但随着<span class="arithmatex">\(l\)</span>的增长，<span class="arithmatex">\(\sigma_h^2(l)\)</span>线性增长且无限制，因而如果<span class="arithmatex">\(\alpha_0\)</span>不为零，则远期方程是无法收敛的，<strong>又因为<span class="arithmatex">\(\alpha_0 \geq 0\)</span>，所以<span class="arithmatex">\(\alpha_0 = 0\)</span>才能使得模型有意义</strong>。</p>
<p><img alt="IGARCH Figure" src="../image/3_ConditionalHeter/3_1_ArunaFigureIGARCH.jpg" /></p>
<p>【3】 <strong>特殊情形：<span class="arithmatex">\(\alpha_0 = 0\)</span></strong>。<span class="arithmatex">\(\alpha_0 = 0\)</span>的模型常用于计算在险价值（Value at Risk，VaR）的模型RiskMatrics。这个模型的好处在于，这是一个关于<span class="arithmatex">\(\{a_t^2\}\)</span>序列的指数平滑(exponential smoothing)的模型：</p>
<div class="arithmatex">\[
\begin{aligned}
   \sigma_t^2 &amp;= (1- \beta_1) a_{t-1}^2 + \beta_1 \sigma_{t-1}^2 \nonumber\\
   &amp;= (1-\beta_1) a_{t-1}^2 + \beta_1 (1-\beta_1) a_{t-2}^2 +  \beta_1^2( \sigma_{t-2}^2 \nonumber\\
   &amp;= \ldots \nonumber\\
   &amp;= (1-\beta_1) (a_{t-1}^2 + \beta_1 a_{t-2}^2 + \beta_1^2 a_{t-3}^2 + \ldots )
\end{aligned}
\]</div>
<p>由于<span class="arithmatex">\(\beta_1 &lt; 1\)</span>，因而逐渐降低远期扰动对当期波动率的影响。这种模型也可用于估计I-GARCH(1,1)模型的参数。</p>
<h3 id="garch_2">门限GARCH</h3>
<p>The Threshold GARCH，简称T-GARCH。其特点在于加入了波动项为负值的指示变量<span class="arithmatex">\(N_{t-i}\)</span>。T-GARCH(m,s)模型的基本形式为：</p>
<div class="arithmatex">\[
\sigma_t^2 = \alpha_0 + \sum_{i=1}^s (\alpha_i + \gamma_i N_{t-i})a_{t-i}^2 + \sum_{j=1}^m \beta_j \sigma_{t-j}^2
\]</div>
<p>其中<span class="arithmatex">\(N_{t-i}\)</span>为指示变量，表明对应的<span class="arithmatex">\(a_{t-i}\)</span>是否为负项：</p>
<div class="arithmatex">\[
N_{t-i} = \left\{\begin{array}{cc}
    1 &amp;\quad \text{if}\quad  a_{t-i} \leq 0  \\
    0 &amp; \quad \text{if}\quad  a_{t-i} &gt; 0
\end{array}\right.
\]</div>
<p>而参数序列<span class="arithmatex">\(\alpha_i, \gamma_i, \beta_i\)</span>均为非负参数，其他要求参照普通的GARCH。该模型可以在一定程度上刻画波动率的“杠杆效应”，即标的资产价格大涨、大跌的情况中，波动率的反应存在的不对称性。对于正向的过往扰动，这个模型如同正常的GARCH(m,s)，而对于负向的扰动，则模型加入了更高的系数（<span class="arithmatex">\(\gamma_i &gt; 0\)</span>），从而模拟在利空行情中波动率的更大规模变化。</p>
<p>在T-GARCH中，默认的“门限”是<span class="arithmatex">\(a_{t-i} = 0\)</span>，也有模型采用其他的阈值，例如CJR模型。</p>
<h3 id="garch_3">指数GARCH</h3>
<p>The Exponential GARCH。简称E-GARCH。这个模型也针对波动率的不对称性质。该模型定义了一个加权因子：</p>
<div class="arithmatex">\[
g(\epsilon_t) = \theta \epsilon_t + \gamma [|\epsilon_t| - E(|\epsilon_t|) ] \tag{15}\label{eq: EGARCHweight}
\]</div>
<p>其中<span class="arithmatex">\(\theta, \gamma\)</span>为常数，<span class="arithmatex">\(\epsilon_t, |\epsilon_t| - E(|\epsilon_t|)\)</span>均为零均值独立同分布随机序列。因而有<span class="arithmatex">\(E[g(\epsilon_t)] = 0\)</span>，且对于<span class="arithmatex">\(\epsilon_t\)</span>的不同取值，<span class="arithmatex">\(g(\epsilon_t)\)</span>的序列存在不同：</p>
<div class="arithmatex">\[
g(\epsilon_t) = \left\{\begin{array}{cc}
   (\theta + \gamma) \epsilon_t - \gamma E(|\epsilon_t|) &amp; \quad  \epsilon \geq 0\\
   (\theta - \gamma) \epsilon_t - \gamma E(|\epsilon_t|)&amp; \quad \epsilon &lt; 0
\end{array}\right.
\]</div>
<p>基于以上内容，E-GARCH(m,s)模型的形式被定义为：</p>
<div class="arithmatex">\[
a_t = \sigma_t \epsilon_t, \quad \ln(\sigma_t^2) = \alpha_0 + \frac{1+\beta_1 B + \ldots + \beta_{s-1} B^{s-1}}{1-\alpha_1 B - \ldots - \alpha_m B^m} g(\epsilon_{t-1})
\]</div>
<p><span class="arithmatex">\(B\)</span>是向后推移算子，从而有<span class="arithmatex">\(Bg(\epsilon_t) = g(\epsilon_{t-1})\)</span>。且要求多项式<span class="arithmatex">\((1+\beta_1 B + \ldots + \beta_{s-1} B^{s-1})\)</span>和<span class="arithmatex">\((1-\alpha_1 B - \ldots - \alpha_m B^m)\)</span>的零点（方程的根）的模都大于1，即都在单位圆之外。</p>
<p>相较于原始GARCH，E-GARCH具有如下的特性：</p>
<ul>
<li><span class="arithmatex">\(E[\ln \sigma_t^2] = \alpha_0\)</span>;</li>
<li>模型使用条件方差的对数，放松了对模型系数非负的限制；</li>
<li><span class="arithmatex">\(g(\epsilon_t)\)</span>的使用，使得模型对<span class="arithmatex">\(a_t\)</span>的滞后项的反应不对称。</li>
</ul>
<hr />
<p>下面考虑E-GARCH(1,1)模型，其形式为：</p>
<div class="arithmatex">\[
\begin{align}
a_t &amp;= \sigma_t \epsilon_t\\
(1-\alpha_1 B)\ln(\sigma_t^2) &amp;= (1-\alpha_1)\alpha_0 + g(\epsilon_{t-1}) \Rightarrow \ln(\sigma_t^2) = (1-\alpha_1)\alpha_0 + g(\epsilon_{t-1}) + \alpha_1 \ln(\sigma_{t-1}^2)
\end{align}
\]</div>
<p>假定<span class="arithmatex">\(\epsilon_t\)</span>服从标准正态分布，而对于服从标准正态分布的<span class="arithmatex">\(\epsilon_t\)</span>，<span class="arithmatex">\(E(|\epsilon_t|) = \sqrt{2/\pi}\)</span>。</p>
<blockquote>
<p>额外聊两句，如果<span class="arithmatex">\(\epsilon_t\)</span>服从学生t分布，则：</p>
<div class="arithmatex">\[
E(|\epsilon_t|) = \frac{2\sqrt{v-2}\Gamma[(v+1)/2]}{(v-1)\Gamma(v/2)\sqrt{\pi}}
\]</div>
<p>但这里，我们假定的是服从标准正态分布。</p>
</blockquote>
<p>参考式<span class="arithmatex">\(\eqref{eq: EGARCHweight}\)</span>，可得E-GARCH(1,1)模型的加权项形式：</p>
<div class="arithmatex">\[
g(\epsilon_{t-1}) = \theta \epsilon_{t-1} + \gamma(|\epsilon_{t-1}|- \sqrt{2/\pi})
\]</div>
<p>那么，讨论<span class="arithmatex">\(\epsilon_{t-1}\)</span>的取值情况，可以把<span class="arithmatex">\(\ln(\sigma_t^2)\)</span>的取值讨论出来：</p>
<div class="arithmatex">\[
\ln(\sigma_t^2) = (1-\alpha_1)\alpha_0 -\gamma \sqrt{2/\pi} + \alpha_1 \ln(\sigma_{t-1}^2)+\left\{\begin{array}{cc}
    (\gamma + \theta ) \epsilon_{t-1}, &amp; \epsilon_{t-1} \geq 0 \\
    (\gamma - \theta) |\epsilon_{t-1}|, &amp; \epsilon_{t-1} &lt; 0
\end{array} \right.
\]</div>
<p>注意<span class="arithmatex">\(\epsilon_{t-1}\)</span>时取值中的绝对值号。令<span class="arithmatex">\(a_{*} = (1-\alpha_1)\alpha_0 - \gamma \sqrt{2/\pi}\)</span>，并对上式做反对数变化（两边取自然指数）：</p>
<div class="arithmatex">\[
\sigma_t^2 = \sigma_{t-1}^{2\alpha_1} + e^{a_{*}} + \left\{\begin{array}{cc}
    (\gamma + \theta ) \epsilon_{t-1}, &amp; \epsilon_{t-1} \geq 0 \\
    (\gamma - \theta) |\epsilon_{t-1}|, &amp; \epsilon_{t-1} &lt; 0
\end{array} \right.
\]</div>
<p>而<span class="arithmatex">\(\epsilon_{t-1} = a_{t-1} / \sigma_{t-1}\)</span>，而标准差<span class="arithmatex">\(\sigma_{t-1}\)</span>必然不可能为负，因而上式的讨论条件可以变成<span class="arithmatex">\(a_{t-1}\)</span>的正负情况，换句话说，方差<span class="arithmatex">\(\sigma_t^2\)</span>的取值情况受上一期的扰动<span class="arithmatex">\(a_{t-1}\)</span>的影响。但由于上式中正负条件下影响系数存在区别，<span class="arithmatex">\(a_{t-1} \geq 0\)</span>下为<span class="arithmatex">\((\gamma + \theta)\)</span>，而<span class="arithmatex">\(a_{t-1} &lt; 0\)</span>时为<span class="arithmatex">\((\gamma- \theta)\)</span>，因此E-GARCH模型可以体现金融市场对正负波动的不对称响应情况（但不对称的前提是<span class="arithmatex">\(\theta \not = 0\)</span>）。</p>
<h2 id="36-var">3.6 在险价值(VaR)</h2>
<p>若干个大小写各异的VaR中的一个，全名Value at Risk。Tsay书对应章节为Chapter 7.1。</p>
<div class="admonition note">
<p class="admonition-title">还有什么var？</p>
<p>var/Var是方差，Variance；VaR是在险价值,Value at Risk; VAR通常指向量自回归模型,Vector AutoRegression。</p>
</div>
<h3 id="_4">风险分类和评估方法</h3>
<p>金融风险可以分为若干类，通常分法为：</p>
<ol>
<li><strong>信用风险/违约风险</strong>。一类长期的风险，由于交易对手方不履行到期债务而造成己方损失的风险。</li>
<li><strong>市场风险</strong>。通常为中期风险，由基础市场价格变动导致的资产价格波动。既可以是当下市场的风险，也可以来自利率、汇率等市场。</li>
<li><strong>流动性风险</strong>。相对短期的风险，资产无法即时、低成本地转化为现金（并支付到期债务）的风险。</li>
<li><strong>购买力风险</strong>。来自通货膨胀导致手中流动性贬值的风险。</li>
<li><strong>其他风险</strong>。其他可能造成金融市场影响的风险，如政治、法律、财政、行业原因的风险。</li>
</ol>
<p>而VaR看的是其中的信用风险。信用风险的评估方法有很多，如：</p>
<ul>
<li>信用评级，所谓AAA/AA/A/BBB/BB/B等等，不同机构有不同分法。信用评级之间存在变换，而评级间变化的概率如同马尔科夫链的转换矩阵。</li>
<li>VaR，下面具体讲。</li>
<li>Altman Z-score。主要利用会计信息的信用评估。</li>
<li>KMV model。通过BSM模型反推“期望违约频率”（expected default frequency, EDF)，一般会用到该公司的股价和资产负债表。</li>
</ul>
<p>此外，为了控制信用风险，信用违约互换（CDS）应运而生，这是一种在规定期限内买卖双方就规定的信用事件进行风险转换的合约。特点在于透明性、市场化程度高、风险可控性好。</p>
<h3 id="var">VaR的定义</h3>
<div class="admonition info">
<p class="admonition-title">定义3.1 VaR</p>
<p>令<span class="arithmatex">\(\Delta V(\mathscr{l})\)</span>表示金融头寸中从<span class="arithmatex">\(t\)</span>到<span class="arithmatex">\((t+\mathscr{l})\)</span>时刻标的资产价值的改变量，令<span class="arithmatex">\(L(\mathscr{l})\)</span>为对应的损失函数，令<span class="arithmatex">\(F_{\mathscr{l}}(x)\)</span>为<span class="arithmatex">\(L(\mathscr{l})\)</span>的CDF。则一个持有期为<span class="arithmatex">\(\mathscr{l}\)</span>，尾部概率为<span class="arithmatex">\(p\)</span>的金融头寸的VaR定义为：</p>
<div class="arithmatex">\[
p = Prob(L(\mathscr{l}) \geq \operatorname{VaR}) = 1 - Prob(L(\mathscr{l}) &lt; \operatorname{VaR}) = 1-F_{\mathscr{l}}(\operatorname{VaR})
\]</div>
<p>关于<span class="arithmatex">\(L(\mathscr{l})\)</span>：如果做多，<span class="arithmatex">\(L(\mathscr{l}) = - \Delta V(\mathscr{l})\)</span>，如果做空则<span class="arithmatex">\(L(\mathscr{l}) = \Delta V(\mathscr{l})\)</span>。</p>
</div>
<p>以上定义表明，VaR是一个分位点的概念，这个概念关注的是造成极端大损失的尾部风险，如下图所示（来自英文Wiki）。</p>
<p><img alt="VaR_tail_risk" src="../image/3_ConditionalHeter/3_2_VaR_diagram.jpg" /></p>
<p>VaR用来警示的就是那部分红色（5%概率）的极端风险，而分位点的位置就是所谓VaR的值。如果用<span class="arithmatex">\(L_{\mathscr{l}}(x)\)</span>的方法来定义，则红色区域应该是右侧的尾部，换句话说就是把上图镜像翻转过来。但无论是怎么定义，VaR关注的绝对不是极端收益，而是极端损失。<strong>在下面计算VaR时采用损失函数的定义，也就是以右侧尾部作为极端损失。</strong></p>
<p>影响VaR的因素包括：</p>
<ol>
<li><strong>概率<span class="arithmatex">\(p\)</span>的取值</strong>。通常定义VaR用的是1%概率（<span class="arithmatex">\(p = 0.01\)</span>），而银行业的压力测试则通常用<span class="arithmatex">\(p =  0.001\)</span>，以检验在极端风险下金融系统的稳定性。</li>
<li><strong>时间长度<span class="arithmatex">\(\mathscr{l}\)</span></strong>。通常检验股票市值风险时采用1、10天，检验信用风险采用的一般是1、5年。</li>
<li><strong>数据频率</strong>。如果数据拆分越细，那么<span class="arithmatex">\(\mathscr{l}\)</span>时间（这是个自然时间）中涵盖的数据期数越多，从而VaR估计出的结果越好。</li>
<li><strong>CDF</strong>。VaR和收益率的分布有关，如果分布/指定概率分位数未知，则要根据历史数据情况做仿真，先估计分布，再根据分布找分位点。</li>
<li><strong>金融头寸的数量或组合的市值</strong>。</li>
</ol>
<h3 id="var_1">VaR的计算</h3>
<p>VaR有两个，一个是代表分位点的VaR收益率，一个是绝对的VaR金额。RiskMetrics模型假定在已知当前信息集<span class="arithmatex">\(\mathscr{F}_t\)</span>的情况下，<span class="arithmatex">\(k\)</span>日范围内的收益率服从正态分布：</p>
<div class="arithmatex">\[
r_t(k) \mid \mathscr{F} \sim N(0,k\sigma_{t+1}^2)
\]</div>
<p>那么，对于概率为<span class="arithmatex">\(p\)</span>的VaR，应当有：</p>
<div class="arithmatex">\[
\operatorname{VaR}(k) = x_p \sqrt{k} \sigma_{t+1} = \sqrt{k}\sigma_{t+1}\Phi^{-1}(1 - p)
\]</div>
<p><span class="arithmatex">\(\Phi^{-1}\)</span>即标准正态分布CDF的反函数，注意这里用的是<span class="arithmatex">\(1-p\)</span>，表示右侧分位点。例如设<span class="arithmatex">\(p = 0.01\)</span>，则分位点位于<span class="arithmatex">\(x_p =\Phi^{-1}(0.99) = 2.326\)</span>，从而有<span class="arithmatex">\(\operatorname{VaR}(k) = 2.326\sqrt{k}\sigma_{t+1}\)</span>。这里计算出的是收益率VaR，基于下式即可计算出金额的VaR：</p>
<div class="arithmatex">\[
\text{VaR 金额} = \text{头寸金额} \times \operatorname{VaR}(k)
\]</div>
<h3 id="var_2">VaR的优缺点</h3>
<p>优点在于（1）易于理解，计算简单；（2）业界用的多；</p>
<p>缺点在于（1）不能满足子可加性(sub-additivity)；（2）不能完全描述损失的上尾部情况（VaR只表示那个代表挺高风险的分位点，但比分位点处风险更严重的那部分VaR完全没有提及。</p>
<p>为了更好的度量风险情况，这里引入一致性风险度量(CRM)的概念。</p>
<h2 id="37">3.7 一致性风险度量</h2>
<p>Coherent risk measure, CRM。指的是满足单调性、子可加性、正齐次性、平移不变性的风险度量。考虑可测函数的线性空间<span class="arithmatex">\(\mathcal{L}\)</span>，泛函<span class="arithmatex">\(\varrho: \mathcal{L} \to \mathbb{R} \cup \{+\infty\}\)</span>被称作一致性风险度量的前提是满足以下条件：</p>
<p>【1】<strong>正规化</strong>(normalized)：<span class="arithmatex">\(\varrho(0) = 0\)</span>。</p>
<blockquote>
<p>不持有任何资产，则风险为0；</p>
</blockquote>
<p>【2】<strong>单调性</strong>(monotonicity)：如果<span class="arithmatex">\(Z_1, Z_2 \in \mathcal{L}\)</span>且<span class="arithmatex">\(Z_1 \leq Z_2\)</span>几乎处处成立，那么<span class="arithmatex">\(\varrho(Z_1)\geq \varrho(Z_2)\)</span>。</p>
<blockquote>
<p>如果资产<span class="arithmatex">\(Z_2\)</span>几乎在任意情况下价值都高于<span class="arithmatex">\(Z_1\)</span>，那么<span class="arithmatex">\(Z_2\)</span>的风险自然应当小于<span class="arithmatex">\(Z_1\)</span>。更人话的说法是，未来收益更好的资产风险更低。</p>
</blockquote>
<p>【3】<strong>子可加性</strong>(sub-additivity):如果<span class="arithmatex">\(Z_1,Z_2 \in \mathcal{L}\)</span>，那么<span class="arithmatex">\(\varrho(Z_1+Z_2) \leq \varrho(Z_1) + \varrho(Z_2)\)</span>。</p>
<blockquote>
<p>在两种资产中分散风险，比独立购买两个资产的风险要小——除非两种资产完全正相关，这个假定表明了在各类资产中分散风险是有好处的。但Dhaene等人(2008)认为一致性风险度量的子可加性假定是存在问题的。</p>
<p>参考文献：Dhaene, J., Laeven, R. J., Vanduffel, S., Darkiewicz, G., &amp; Goovaerts, M. J. (2008). Can a coherent risk measure be too subadditive?. <em>Journal of Risk and Insurance</em>, <em>75</em>(2), 365-386.</p>
</blockquote>
<details>
<summary>VaR不满足子可加性的例子</summary>
<p>为什么VaR不是一致性风险度量？因为不满足子可加性，下面给一个数值例：</p>
<p><em>给出两个</em><em>独立</em><em>资产和各自确定的投资损失：每一种资产都有96%概率得到1元利润，而4%概率遭到2元损失。</em></p>
<p>给定<span class="arithmatex">\(\alpha = 0.95\)</span>（即上文中的<span class="arithmatex">\(p = 0.05\)</span>），则单个资产的<span class="arithmatex">\(\operatorname{VaR}_a(x) = -1, x \in \{Z_1,Z_2\}\)</span>。而对于这个组合来说，<span class="arithmatex">\(\operatorname{VaR}_\alpha(Z_1+Z_2) = 1\)</span>：</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Scenario</th>
<th style="text-align: center;">Overall Loss</th>
<th style="text-align: center;">PDF</th>
<th style="text-align: center;">CDF</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(F(Z_1) = -1, F(Z_2) = -1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(96\% \times 96\% = 92.16\%\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(92.16\%\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(F(Z_1) = 2, F(Z_2) = -1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\% \times 96\% = 3.84\%\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(96\%\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(F(Z_1) = -1, F(Z_2) = 2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\% \times 96\% = 3.84\%\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(99.84\%\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(F(Z_1) = 2, F(Z_2) = 2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\% \times 4\% = 0.16\%\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(100\%\)</span></td>
</tr>
</tbody>
</table>
<p><span class="arithmatex">\(95\%\)</span>分位点显然对应损失值<span class="arithmatex">\(1\)</span>，从而有<span class="arithmatex">\(\operatorname{VaR}_\alpha(Z_1+Z_2) = 1\)</span>。所以：</p>
<div class="arithmatex">\[
VaR(Z_1 + Z_2) = 1 &gt; VaR(Z_1) + VaR(Z_2) = -2\nonumber
\]</div>
<p>显然VaR不满足子可加性。</p>
</details>
<p>【4】<strong>正齐次性</strong>(positive homogeneity)：如果实数<span class="arithmatex">\(\alpha \geq 0\)</span>, 资产<span class="arithmatex">\(Z \in \mathcal{L}\)</span>，那么<span class="arithmatex">\(\varrho(\alpha Z) = \alpha \varrho(Z)\)</span>。</p>
<blockquote>
<p>资产构成不变的情况下，资产规模越大，风险越大，而且是正比例函数。</p>
</blockquote>
<div class="admonition info">
<p class="admonition-title">风险的凸测度</p>
<p>Föllmer &amp; Schied(2002)提出了风险的凸测度(convex risk measures)，即一致性风险度量的<strong>子可加性</strong>和<strong>正齐次性</strong>可以被凸性替代：</p>
<p><em>如果</em><span class="arithmatex">\(Z_1,Z_2 \in \mathcal{L}\)</span>，<em>且实数</em><span class="arithmatex">\(\lambda \in [0,1]\)</span>，<em>则</em><span class="arithmatex">\(\varrho[\lambda Z_1 + (1-\lambda)Z_2] \leq \lambda \varrho(Z_1) + (1-\lambda) \varrho(Z_2)\)</span></p>
<p>参考文献：Föllmer, H., &amp; Schied, A. (2002). Convex measures of risk and trading constraints. <em>Finance and stochastics</em>, <em>6</em>(4), 429-447.</p>
</div>
<p>【5】<strong>平移不变性</strong>(translation invariance)：对于无风险资产<span class="arithmatex">\(A\)</span>（给予确定性收益<span class="arithmatex">\(a\)</span>）和风险资产<span class="arithmatex">\(Z \in \mathcal{L}\)</span>，应有<span class="arithmatex">\(\varrho(Z+A) = \varrho(Z) - a\)</span>。</p>
<blockquote>
<p>资产组合中加入无风险资产会降低组合的风险，而且加得越多，（按照无风险资产的确定性收益额度）风险减的越多。</p>
</blockquote>
<h3 id="varvar">条件VaR：满足一致性风险度量的VaR变种</h3>
<p>设随机变量<span class="arithmatex">\(X \sim N(0,1)\)</span>，给定上尾部概率<span class="arithmatex">\(p\)</span>，令<span class="arithmatex">\(q = 1-p\)</span>，而<span class="arithmatex">\(VaR_q\)</span>为相关VaR，也即<span class="arithmatex">\(VaR_q\)</span>是<span class="arithmatex">\(X\)</span>的<span class="arithmatex">\(q\)</span>分位数。在<span class="arithmatex">\(X &gt; VaR_q\)</span>的情况下，<span class="arithmatex">\(X\)</span>的期望值：</p>
<div class="arithmatex">\[
E(X\mid X &gt; VaR_q) = f(VaR_q) / p
\]</div>
<p>其中<span class="arithmatex">\(f(x)\)</span>为标准正态分布的PDF。则对条件分布为<span class="arithmatex">\(N(0,\sigma_t^2)\)</span>的对数收益率<span class="arithmatex">\(r_t\)</span>，其预期损失可以定义为：</p>
<div class="arithmatex">\[
ES_q = \frac{f(VaR_q)}{p} \sigma_t
\]</div>
<p>CVaR是对整个右尾做了积分，求了均值。显然，CVaR应当远远大于VaR的值。</p>
<h2 id="38-i-garchvar">3.8 风险度量制：基于I-GARCH模型计算VaR</h2>
<p>具体内容参照Tsay书7.2部分。</p>
<p>假定<span class="arithmatex">\(t\)</span>时刻，有日条件对数收益率序列<span class="arithmatex">\(\{r_t \mid F_{t-1}\} \sim N(\mu_t, \sigma_t^2)\)</span>。其中，假定波动率<span class="arithmatex">\(\sigma_t^2\)</span>服从特殊的I-GARCH(1,1)模型，这个模型的形式为：</p>
<div class="arithmatex">\[
\mu_t = 0,\quad a_t = \sigma_t \epsilon_t, \quad \sigma_t^2 = \alpha \sigma_{t-1}^2 + (1-\alpha) r_{t-1}^2
\]</div>
<p>显然，这是一个无漂移项的I-GARCH过程。其中，要求<span class="arithmatex">\(a_t = \ln(P_t) - \ln(P_{t-1})\)</span>满足价格的对数差分方程，且<span class="arithmatex">\(\alpha \in (0.9,1)\)</span>。由以上设定，可以计算对数收益率的波动率变化。</p>
<p>对<span class="arithmatex">\(k\)</span>个持有期，应当有：</p>
<div class="arithmatex">\[
r_t [k] = r_{t+1} + \ldots + r_{t+k}
\]</div>
<p>而每一期都服从I-GARCH(1,1)模型，那么整体<span class="arithmatex">\(r_t[k]\)</span>的条件分布服从：</p>
<div class="arithmatex">\[
r_t[k] \mid F_t \sim N(0,\sigma_{t[k]}^2)
\]</div>
<p>接下来的任务是估计<span class="arithmatex">\(\sigma_{t[k]}^2\)</span>，需要利用一些性质。由<span class="arithmatex">\(\epsilon_t^2\)</span>的独立同分布性质，有：</p>
<div class="arithmatex">\[
\sigma_{t[k]}^2 = \operatorname{Var}(r_{t}[k]\mid F_t) = \sum_{i=1}^k \operatorname{Var}(a_{t+i}\mid F_t)
\]</div>
<p>需要预测向前<span class="arithmatex">\(i\)</span>步波动率的条件期望<span class="arithmatex">\(E(\sigma_{t+1}^2\mid F_t)\)</span>，又因为<span class="arithmatex">\(r_{t-1} = a_{t-1} = \sigma_{t-1} \epsilon_{t-1}\)</span>带入I-GARCH模型：</p>
<div class="arithmatex">\[
\begin{aligned}
\sigma_{t}^2 &amp;= \alpha \sigma_{t-1}^2 + (1-\alpha) \sigma_{t-1}^2 \epsilon_{t-1}^2\\
&amp;= \sigma_{t-1}^2 + (1-\alpha) \sigma_{t-1}^2 (\epsilon_{t-1}^2 - 1), \quad \forall t
\end{aligned}
\]</div>
<ul>
<li>对于<span class="arithmatex">\(i \geq 2\)</span>时（向前两步以上预测），由上式，有：</li>
</ul>
<div class="arithmatex">\[
\sigma_{t+i}^2 = \sigma_{t+i-1}^2 + (1-\alpha)\sigma_{t+i-1}^2 (\epsilon_{t+i-1}^2 - 1)\\
\Rightarrow \quad E(\sigma_{t+i}^2 \mid F_t) = E(\sigma_{t+i-1}^2 \mid F_t), \quad i = 2,....
\]</div>
<ul>
<li>对于<span class="arithmatex">\(i = 1\)</span>的情形，由I-GARCH模型，有：</li>
</ul>
<div class="arithmatex">\[
\begin{aligned}
\sigma_{t+1}^2 &amp;= \alpha \sigma_t^2 + (1-\alpha) \sigma_t^2 r_t^2 = \sigma_t^2 + (1-\alpha) \sigma_t^2 (\epsilon_t^2 - 1)\\
\text{两边同取条件期望} \quad  E(\sigma_{t+1}^2) &amp;= E(\sigma_t^2\mid F_t) = \operatorname{Var}(r_{t-1}\mid F_t)
\end{aligned}
\]</div>
<p>上式取条件期望时，<span class="arithmatex">\(\epsilon_t \sim N(0,1)\)</span>，从而<span class="arithmatex">\(E(\epsilon_t^2 - 1) = \operatorname{Var}(\epsilon_t)-1 = 0\)</span>。从而对于任意的<span class="arithmatex">\(i \geq 1\)</span>，有<span class="arithmatex">\(\operatorname{Var}(r_{t+i} \mid F_t) = \sigma_{t+1}^2\)</span>，即有<span class="arithmatex">\(\sigma_{t[k]}^2 = k\sigma_{t+1}^2\)</span>。这说明<span class="arithmatex">\(r_t[k] \mid F_t \sim N(0,k\sigma_{t+1}^2)\)</span>。在I-GARCH(1,1)模型下，条件方差与时间<span class="arithmatex">\(k\)</span>成正比，而<span class="arithmatex">\(k\)</span>个持有期的收益率<span class="arithmatex">\(r_t \mid F_t\)</span>的条件方差为<span class="arithmatex">\(\sqrt{k}\sigma_{t+1}\)</span>，这意味着只需要基于现有信息估计出下一期的标准差，就可以估计出未来各期的标准差，且长期看来标准差是收敛的。</p>
<p>由以上内容，可以计算VaR的值，这就是RiskMetrices方法，要求<span class="arithmatex">\(r_t[k] \mid F_t \sim N(0,k\sigma_{t+1}^2)\)</span>。设尾部概率<span class="arithmatex">\(5\%\)</span>，则下一个交易日的VaR为<span class="arithmatex">\(1.65\sigma_{t+1}\)</span>（1.65为标准正态分布的<span class="arithmatex">\(95\%\)</span>分位点），而<span class="arithmatex">\(\sigma_{t+1}\)</span>直接由I-GARCH(1,1)模型做一步预测得来，而<span class="arithmatex">\(k\)</span>个交易日（较短期内）的VaR为<span class="arithmatex">\(1.65\sqrt{k} \sigma_{t+1}\)</span>。如果调整尾部概率为<span class="arithmatex">\(1\%\)</span>，则单日VaR为<span class="arithmatex">\(2.326\sigma_{t+1}\)</span>，同理，<span class="arithmatex">\(k\)</span>日VaR为<span class="arithmatex">\(2.326\sqrt{k}\sigma_{t+1}\)</span>。</p>
<p>风险度量制方法计算VaR的优缺点：</p>
<ul>
<li>优点：（1）简洁易理解；（2）使得风险更加透明、量化；</li>
<li>缺点：（1）要求正态假设，往往使得VaR被低估；（2）<span class="arithmatex">\(r_t\)</span>的均值非零时失效。</li>
</ul>
<details>
<summary>两个缺点的额外解释</summary>
<p>缺点一（正态分布假设）：I-GARCH只考虑了四阶矩信息，没有考虑（或只是部分考虑到）波动率分布尖峰厚尾的性质。</p>
<p>缺点二（均值非零时失效）：如果<span class="arithmatex">\(r_t\)</span>均值非0，则<span class="arithmatex">\(r_t[k] \sim N(k\mu, k \sigma_{t+1}^2)\)</span>，即存在漂移项。在<span class="arithmatex">\(p = 0.05\)</span>时，<span class="arithmatex">\(\operatorname{VaR}[k] = k\mu + 1.65\sqrt{k}\sigma_{t+1}^2\)</span>，看起来，这个问题是可控的。</p>
</details>
<h3 id="var_3">计算组合的VaR</h3>
<p>设<span class="arithmatex">\(VaR_1\)</span>和<span class="arithmatex">\(VaR_2\)</span>分别代表两个资产头寸的VaR，两资产收益率存在相关系数<span class="arithmatex">\(\rho_{12}\)</span>，显然<span class="arithmatex">\(\rho_{12} = \operatorname{Cov}(r_{1t},r_{2t}) / \sqrt{\operatorname{Var}(r_{1t})\operatorname{Var}(r_{2t})}\)</span>。那么组合的VaR如下式：</p>
<div class="arithmatex">\[
VaR_p = \sqrt{VaR_1^2 + VaR_2^2 + 2\rho_{12} VaR_1 VaR_2}
\]</div>
<p>对于<span class="arithmatex">\(m\)</span>个头寸，其VaR为：</p>
<div class="arithmatex">\[
VaR =\sqrt{ \sum_{i=1}^m VaR_i^2 + 2\sum_{i &lt; j}^m \rho_{ij} VaR_i VaR_j}
\]</div>
<p>利用以上方法计算组合VaR的前提条件是：所有资产的对数收益率均服从相同的，均值为0、协方差为<span class="arithmatex">\(\mathbf{\Sigma}_{t+1}\)</span>的正态分布。</p>
<h2 id="39-var">3.9 VaR的分位数估计方法（非参方法）</h2>
<p>分为两类：经验分位数方法、分位数估计。</p>
<h3 id="_5">经验分位数</h3>
<p>首先定义次序统计量。</p>
<div class="admonition info">
<p class="admonition-title">定义3.2 - 次序统计量</p>
<p>令<span class="arithmatex">\(r_1,…,r_n\)</span>表示样本组合收益率，并递增排序，记为:<span class="arithmatex">\(r_{(1)} \leq r_{(2)} \leq … \leq r_{(n)}\)</span>，其中<span class="arithmatex">\(r_{(i)}\)</span>为样本的第<span class="arithmatex">\(i\)</span>个次序统计量。若收益率独立同分布且服从一个连续的分布，其PDF为<span class="arithmatex">\(f(x)\)</span>，CDF为<span class="arithmatex">\(F(x)\)</span>，则次序统计量<span class="arithmatex">\(r_{(l)}\)</span>，其中<span class="arithmatex">\(l = np\)</span>且<span class="arithmatex">\(0&lt; p &lt; 1\)</span>，有如下结论成立：</p>
<p><em>令<span class="arithmatex">\(x_p\)</span>表示<span class="arithmatex">\(F(x)\)</span>在概率<span class="arithmatex">\(p\)</span>处的分位点，即<span class="arithmatex">\(x_p\)</span> = F(p)^{-1}。假定<span class="arithmatex">\(f(x)\)</span>在<span class="arithmatex">\(x_p\)</span>处不为0，即<span class="arithmatex">\(f(x_p) \not = 0\)</span>，则次序统计量<span class="arithmatex">\(r_{(l)}\)</span>是渐近正态的，其均值为<span class="arithmatex">\(x_p\)</span>，方差为<span class="arithmatex">\(p(1-p)/ [nf^2(x_p)]\)</span>。</em></p>
</div>
<p>当<span class="arithmatex">\(l\)</span>非整，则可以利用插值法来做分位数的估计，取<span class="arithmatex">\(np\)</span>相邻的整数，即<span class="arithmatex">\(l_1 &lt; np &lt; l_2\)</span>，定义<span class="arithmatex">\(p_i = l_i / n\)</span>，从而有<span class="arithmatex">\(p_1 &lt; p &lt; p_2\)</span>，可利用：</p>
<blockquote>
<p><span class="arithmatex">\(l\)</span>是次序，必然整数，但这里的<span class="arithmatex">\(l\)</span>并非给定的值，而是<span class="arithmatex">\(np\)</span>的和，<span class="arithmatex">\(n\)</span>是给定的整数，但<span class="arithmatex">\(p\)</span>取到的点未必能使得<span class="arithmatex">\(np\)</span>为整数，因此需要插值。</p>
</blockquote>
<div class="arithmatex">\[
\hat x_p = \frac{p_2 - p}{p_2 - p_1} r(l_1) + \frac{p - p_1}{p_2 - p_1}r(l_2)
\]</div>
<p>经验分位数方法的优缺点在于：</p>
<ul>
<li>优点：（1）简单；（2）收益率<span class="arithmatex">\(r_t\)</span>无分布假设（而是采用了分位数渐近服从的正态分布）；</li>
<li>缺点：（1）收益率<span class="arithmatex">\(r_t\)</span>在样本期间和预测期的分布需要一致，参数也要一致；（2）预测损失不能超过历史最大值，否则无法插值，可能导致估计的VaR偏低；（3）对于一些极端的分位数（ <span class="arithmatex">\(p \to 0\)</span> 或 <span class="arithmatex">\(p \to 1\)</span> 处）估计不好，也是难以插值，经验法此时不是理论分位数的有效估计；（4）直接计算分位数无法体现解释变量（过去信息）的影响。</li>
</ul>
<p>使用经验分位数方法还可以计算经验预期损失。令<span class="arithmatex">\(\hat x_q\)</span>为<span class="arithmatex">\(q\)</span>的经验分位数，其中<span class="arithmatex">\(p = 1-q\)</span>，<span class="arithmatex">\(p\)</span>为上尾部概率，则:</p>
<div class="arithmatex">\[
ES_q = \frac{1}{N_q} \sum_{i=1}^n x_i I\{X_{(i)} &gt; \hat x_q\}
\]</div>
<p>其中<span class="arithmatex">\(N_q\)</span>为<span class="arithmatex">\(X_i\)</span>中比<span class="arithmatex">\(\hat x_q\)</span>大的元素数量，<span class="arithmatex">\(I\{\cdot\}\)</span>为示性函数。</p>
<h3 id="_6">分位数回归</h3>
<p>设存在线性回归：</p>
<div class="arithmatex">\[
r_t = \beta^T x_t + a_t
\]</div>
<p>其中，系数<span class="arithmatex">\(\beta\)</span>是一个<span class="arithmatex">\(k\)</span>维参数向量（对应<span class="arithmatex">\(k\)</span>个解释变量），<span class="arithmatex">\(x_t \in F_{t-1}\)</span>为预测向量，<span class="arithmatex">\(\beta^T x_t\)</span>为已知项。那么<span class="arithmatex">\(r_t \mid F_{t-1}\)</span>的条件分布可视作<span class="arithmatex">\(a_t\)</span>分布的平移。在给定<span class="arithmatex">\(F_{t-1}\)</span>的条件下，条件分位数<span class="arithmatex">\(x_p\)</span>的估计：</p>
<blockquote>
<p>这里是<span class="arithmatex">\(a_t\)</span>的分布（而不需要写为条件分布），因为<span class="arithmatex">\(a_t\)</span>和<span class="arithmatex">\(F_{t-1}\)</span>无关，但已知<span class="arithmatex">\(F_{t-1}\)</span>时<span class="arithmatex">\(\beta^T x_t\)</span>是完全已知的。</p>
</blockquote>
<div class="arithmatex">\[
\begin{align}
\hat x_p \mid F_{t-1} &amp;:= \inf \left\{\beta_0^T x \mid R_p(\beta_0) \equiv \min \right\}\\
\text{其中}\quad R_p(\beta_0) &amp;\equiv \min_{\beta_0} \sum_{t=1}^n w_p (r_t - \beta^T x)^2\\
\text{而}\quad w_p(z) &amp;= \left\{\begin{array}{cc}
pz &amp; \text{若}z \geq 0;\\
(p-1)z &amp; \text{若} z &lt; 0
\end{array}\right.
\end{align}
\]</div>
<p>显然，<span class="arithmatex">\(w_p(z)\)</span>为一个罚函数。例如， <span class="arithmatex">\(p= r_t(0.9)\)</span>代表分位数回归，希望回归曲线下包含<span class="arithmatex">\(90\%\)</span>的数据点。</p>
<p>/// detail | 分位数估计与OLS的区别</p>
<p>两者的区别在于罚函数的应用，OLS的估计项为：</p>
<div class="arithmatex">\[
\hat \beta = \operatorname{argmin}_\beta \sum_{t=1}^n (r_t - \beta^T x)^2
\]</div>
<p>在上式中，<span class="arithmatex">\(r_t\)</span>更容易受到极值的影响，而分位数估计则纳入了不同情况的不同罚函数来缓解这一问题，所以可以说分位数估计方法是OLS的改进。
///</p>
<p>分位数回归的优点：（1）无需假定任意阶矩信息的存在；（2）该方法得到的估计是稳健的，不易受极端值的影响；（3）无需对模型中的分布作出假设；（4）分位数估计可以通过设定分位数值来得到不同置信水平下的分位数估计，很适合用于捕捉分布的尾部特征。</p>
<blockquote>
<p>关于优点2：特别是在高频市场和极端市场环境（如金融危机）下进行研究时，分位数回归会更合适。</p>
</blockquote>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 17, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 10, 2023</span>
  </span>

    
    
    
  </aside>





  <h2 id="__comments">评论</h2>
  <script src="https://giscus.app/client.js"
  data-repo="yliu-fe/yliu-fe.github.io"
  data-repo-id="R_kgDOJUL-qg"
  data-category="Announcements"
  data-category-id="DIC_kwDOJUL-qs4CVpQZ"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="top"
  data-theme="preferred_color_scheme"
  data-lang="zh-CN"
  data-loading="lazy"
  crossorigin="anonymous"
  async>
</script>


  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Y. Liu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/yliu-fe" target="_blank" rel="noopener" title="GitHub | yliu-fe" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "navigation.tracking", "navigation.tabs", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate", "navigation.top", "navigation.instant"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>